# Мотивация

В данный момент в системе нет инструментов для отслеживания ошибок и сбоев, это приводит к следующим проблемам:

- Нет возможности превентивно отслеживать возникновение проблем. То, что с заказом возникли проблемы мы узнаем только после жалобы клиентов.
- Нет возможности оперативно исправлять ошибки. Выяснение причин их возникновения может занимать продолжительное время.
- Нет возможности оперативно определять необходимую мощность ресурсов требуемых для работы системы

# Выбор подхода к мониторингу

Для мониторинга в системе будет использован подход "Четыре золотых сигнала"

### Метрики для отслеживания

Первый сигнал — **Задержка**. Чтобы контролировать время отклика различных API, следует использовать следующие метрики:

- **Response time (latency) для shop API** — позволит отслеживать производительность интернет-магазина.
- **Response time (latency) для CRM API** — важна для понимания того, как быстро обрабатываются запросы в CRM.
- **Response time (latency) для MES API** — поможет увидеть, насколько быстро MES отвечает на запросы и рассчитывает стоимость.

Второй сигнал — **трафик**. Здесь уместно использовать:

- **Number of requests (RPS) для internet shop API** — количество запросов к интернет-магазину покажет, как сильно увеличивается нагрузка на систему.
- **Number of requests (RPS) для CRM API** — позволит оценить, насколько интенсивно используется CRM.
- **Number of requests (RPS) для MES API** — нужно для понимания нагрузки на MES, особенно после обострения ситуации с API.
- Также стоит обратить внимание на **Number of requests (RPS) per user для интернет-магазина, CRM и MES API**, чтобы выявить аномалии в использовании и проанализировать поведение пользователей.

Третий сигнал — **Ошибки**. Здесь также имеют значение следующие метрики:

- **Number of HTTP 500 для shop API** — эта метрика поможет уловить ошибки сервера в интернет-магазине.
- **Number of HTTP 500 для CRM API** — помогает отслеживать внутренние ошибки в CRM.
- **Number of HTTP 500 для MES API** — выявит проблемы на уровне производственной системы.
- **Number of dead-letter-exchange letters в RabbitMQ** — покажет наличие сообщений, которые не удалось обработать и которые могут указывать на ошибки взаимодействия.


Четвертый сигнал — **Насыщенность**. Для мониторинга состояния системы необходимо:

- **CPU % для shop API, CRM API, MES API** — отслеживание загрузки процессора поможет выявить, когда нагрузка на серверы становится критической.
- **Memory Utilization для shop API, CRM API, MES API** — использование оперативной памяти важно для оценки производительности и риска сбоев.
- **Memory Utilization для shop db instance и MES db instance** — контроль использования памяти баз данных поможет предотвратить падения системы из-за нехватки ресурсов.


Эти метрики, взятые в совокупности, предоставят четкую картину о состоянии системы и позволят выявить узкие места. Регулярный мониторинг и анализ этих данных поможет быстро реагировать на возникшие проблемы и минимизировать жалобы от клиентов.

# План действий
- Первым этапом нужно определить объекты мониторинга.

- Следующим шагом следует утвердить критери мониторинга. Определяются метрики, такие как скорость отклика, частота ошибок и время работы сервисов, которые критичны для обеспечения их стабильности и производительности.

- На третьем этапе необходимо выбрать инструменты мониторинга. Рекомендуется использование таких решений, как Prometheus и Grafana, обеспечивающих полнофункциональный сбор и визуализацию данных.

- Затем потребуется развертывание и настройка выбранных инструментов. Данный процесс включает установку ПО, конфигурацию интеграций с существующими системами.

- После этого стоит настроить визуализацию метрик с помощью инструментов, таких как Grafana или Kibana.

- Завершает процесс настройка алертов для критических ситуаций.
